{% extends "base.html" %} {% load static %}
<link rel="stylesheet" href="{% static '/css/styles.css' %}"/>
{% block title %}Index - Job.it{% endblock %} {% block navbar_extra %}
    <div class="position-absolute top-50 start-50 translate-middle">
        <button type="button" class="btn btn-secondary me-2" onclick="window.location.href='/'">Search Jobs</button>
        <button type="button" class="btn btn-primary" onclick="window.location.href='/worker_profile'">My Profile
        </button>
    </div>
{% endblock %} {% block content %}
    <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 1050; display: none;" id="toastContainer">
        <div id="customToast" class="toast align-items-center text-bg-primary border-0 d-flex justify-content-between" role="alert" aria-live="assertive" aria-atomic="true">
            <div id="toastMessage" class="toast-body"></div>
            <button type="button" class="btn-close btn-close-white me-2" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
    </div>
    <div class="row gutters-sm">
        <div class="col-md-4 mb-3">
            <div class="card shadow p-2">
                <div class="card-body">
                    <div class="d-flex flex-column align-items-center text-center">

                        <div class="profile-img-wrapper position-relative">
                            <img src="{% static 'images/avatar.png' %}" alt="Admin" class="rounded-circle profile-img"
                                 width="150"/>
                            <div class="overlay">
                                <i class="bi bi-camera-fill"></i>
                                <span>Change photo</span>
                            </div>
                        </div>

                        <div class="mt-3">
                            <div class="d-flex align-items-center justify-content-center mb-1">
                                <h4 class="mb-0 me-2">Firstname Lastname</h4>
                            </div>
                            <div class="d-flex align-items-center justify-content-center mb-1">
                                <div id="positionContent" class="text-secondary mb-0 me-2">Full Stack Developer</div>
                                <div id="positionEdit" style="display: none;">
                                    <div class="d-flex flex-column align-items-center">
                                        <input type="text" class="form-control mb-2" id="positionInput" value="Full Stack Developer">
                                        <div class="d-flex gap-3">
                                            <button type="button" class="btn btn-secondary btn-sm" onclick="cancelEdit('position')">Cancel</button>
                                            <button type="button" class="btn btn-primary btn-sm" onclick="saveEdit('position')">Save</button>
                                        </div>
                                    </div>
                                </div>
                                <div class="d-flex">
                                    <i class="bi bi-pencil edit-icon" style="font-size: 1rem; color: black; cursor: pointer;" onclick="toggleEdit('position')"></i>
                                </div>
                            </div>

                            <div class="d-flex align-items-center justify-content-center mb-2">
                                <div id="locationContent" class="text-muted font-size-sm mb-0 me-2">Bay Area, San Francisco, CA</div>
                                <div id="locationEdit" style="display: none;">
                                    <div class="d-flex flex-column align-items-center">
                                        <input type="text" class="form-control mb-2" id="locationInput" value="Bay Area, San Francisco, CA">
                                        <div class="d-flex gap-3 mb-2">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="remoteCheck" onchange="updateLocationBadges()">
                                                <label class="form-check-label" for="remoteCheck">
                                                    Remote
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="hybridCheck" onchange="updateLocationBadges()">
                                                <label class="form-check-label" for="hybridCheck">
                                                    Hybrid
                                                </label>
                                            </div>
                                        </div>
                                        <div class="d-flex gap-3">
                                            <button type="button" class="btn btn-secondary btn-sm" onclick="cancelEdit('location')">Cancel</button>
                                            <button type="button" class="btn btn-primary btn-sm" onclick="saveEdit('location')">Save</button>
                                        </div>
                                    </div>
                                </div>
                                <div class="d-flex">
                                    <i class="bi bi-pencil edit-icon" style="font-size: 1rem; color: black; cursor: pointer;" onclick="toggleEdit('location')"></i>
                                </div>
                            </div>
                            <div class="d-flex justify-content-center">
                                <div id="locationBadges" class="d-flex gap-2 mt-1">
                                    <span class="badge bg-success" id="remoteBadge" style="display: none;">Remote</span>
                                    <span class="badge bg-warning" id="hybridBadge" style="display: none;">Hybrid</span>
                                </div>
                            </div>
                            <!--
                            <button class="btn btn-primary">Follow</button>
                            <button class="btn btn-outline-primary">Message</button>
                            -->
                        </div>
                    </div>
                </div>
            </div>

            <div class="card shadow mt-3">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h6 class="mb-0">Social Links</h6>
                    <button type="button" class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#socialLinksModal">
                        <i class="bi bi-pencil"></i> Manage Links
                    </button>
                </div>
                <ul class="list-group list-group-flush" id="socialLinksList">
                </ul>
            </div>
        </div>
        <div class="col-md-8">
            <div class="card shadow mb-3">
                <div class="card-body">
                    <div class="row align-items-center mb-2">
                        <div class="col-sm-3">
                            <h6 class="mb-0">Full Name</h6>
                        </div>
                        <div class="col-sm-9 text-secondary d-flex justify-content-between">
                            <div id="fullNameContent">Kenneth Valdez</div>
                            <div id="fullNameEdit" style="display: none;">
                                <input type="text" class="form-control" id="fullNameInput" value="Kenneth Valdez">
                            </div>
                            <div class="d-flex">
                                <i class="bi bi-pencil edit-icon" style="font-size: 1rem; color: black; cursor: pointer;" onclick="toggleEdit('fullName')"></i>
                                <div class="edit-buttons d-flex gap-3 d-none">
                                    <button type="button" class="btn btn-secondary btn-sm" onclick="cancelEdit('fullName')">Cancel</button>
                                    <button type="button" class="btn btn-primary btn-sm" onclick="saveEdit('fullName')">Save</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr/>
                    <div class="row align-items-center mb-2">
                        <div class="col-sm-3">
                            <h6 class="mb-0">Email</h6>
                        </div>
                        <div class="col-sm-9 text-secondary d-flex justify-content-between">
                            <div id="emailContent">fip@jukmuh.al</div>
                            <div id="emailEdit" style="display: none;">
                                <input type="email" class="form-control" id="emailInput" value="fip@jukmuh.al">
                            </div>
                            <div class="d-flex">
                                <i class="bi bi-pencil edit-icon" style="font-size: 1rem; color: black; cursor: pointer;" onclick="toggleEdit('email')"></i>
                                <div class="edit-buttons d-flex gap-3 d-none">
                                    <button type="button" class="btn btn-secondary btn-sm" onclick="cancelEdit('email')">Cancel</button>
                                    <button type="button" class="btn btn-primary btn-sm" onclick="saveEdit('email')">Save</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr/>
                    <div class="row align-items-center mb-2">
                        <div class="col-sm-3">
                            <h6 class="mb-0">Mobile</h6>
                        </div>
                        <div class="col-sm-9 text-secondary d-flex justify-content-between">
                            <div id="mobileContent">(320) 380-4539</div>
                            <div id="mobileEdit" style="display: none;">
                                <input type="tel" class="form-control" id="mobileInput" value="(320) 380-4539">
                            </div>
                            <div class="d-flex">
                                <i class="bi bi-pencil edit-icon" style="font-size: 1rem; color: black; cursor: pointer;" onclick="toggleEdit('mobile')"></i>
                                <div class="edit-buttons d-flex gap-3 d-none">
                                    <button type="button" class="btn btn-secondary btn-sm" onclick="cancelEdit('mobile')">Cancel</button>
                                    <button type="button" class="btn btn-primary btn-sm" onclick="saveEdit('mobile')">Save</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr/>
                    <div class="row align-items-center mb-2">
                        <div class="col-sm-3">
                            <h6 class="mb-0">Starts in</h6>
                        </div>
                        <div class="col-sm-9 text-secondary d-flex justify-content-between">
                            <div id="startsInContent">ASAP</div>
                            <div id="startsInEdit" style="display: none;">
                                <select class="form-select" id="startsInSelect">
                                    <option value="ASAP">ASAP</option>
                                    <option value="2 weeks">2 weeks</option>
                                    <option value="1 month">1 month</option>
                                    <option value="3 months">3 months</option>
                                </select>
                            </div>
                            <div class="d-flex">
                                <i class="bi bi-pencil edit-icon" style="font-size: 1rem; color: black; cursor: pointer;" onclick="toggleEdit('startsIn')"></i>
                                <div class="edit-buttons d-flex gap-3 d-none">
                                    <button type="button" class="btn btn-secondary btn-sm" onclick="cancelEdit('startsIn')">Cancel</button>
                                    <button type="button" class="btn btn-primary btn-sm" onclick="saveEdit('startsIn')">Save</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row gutters-sm">
                <div class="col-sm-6 mb-3">
                    <div class="card shadow h-100">
                        <div class="card-body">
                            <h6 class="d-flex align-items-center mb-3">
                                <i class="material-icons text-info mr-2">About me</i>
                                <i class="bi bi-pencil ms-auto" style="font-size: 1rem; color: black; cursor: pointer;" 
                                   onclick="toggleAboutMeEdit()"></i>
                            </h6>
                            <div id="aboutMeContent" class="about-me-content">
                                {% if about_me %}
                                    {{ about_me }}
                                {% else %}
                                    Tell something about yourself!
                                {% endif %}
                            </div>
                            <div id="aboutMeEdit" class="about-me-edit" style="display: none;">
                                <textarea class="form-control" id="aboutMeText" rows="8" style="min-height: 200px; resize: vertical;" maxlength="250"></textarea>
                                <div class="d-flex justify-content-between align-items-center mt-2">
                                    <small class="text-muted" id="charCounter">250 characters remaining</small>
                                </div>
                                <div class="mt-3 d-flex justify-content-end gap-2">
                                    <button type="button" class="btn btn-secondary btn-sm" onclick="cancelAboutMeEdit()">Cancel</button>
                                    <button type="button" class="btn btn-primary btn-sm" onclick="saveAboutMe()">Save</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 mb-3">
                    <div class="card shadow h-100">
                        <div class="card-body">
                            <h6 class="d-flex align-items-center mb-3"><i
                                    class="material-icons text-info mr-2">Skills</i></h6>
                            <div id="skillsList">
                                {% for skill in skills %}
                                    <div id="skillItem-{{ skill.id }}">
                                        <div class="d-flex align-items-center">
                                            <small class="w-100 text-truncate">{{ skill.name }}</small>
                                            <i class="bi bi-pencil ms-auto"
                                               style="font-size: 1rem; color: black; cursor: pointer;"
                                               onclick="editSkill('{{ skill.id }}', '{{ skill.level }}', '{{ skill.name }}')"
                                               data-bs-toggle="modal" data-bs-target="#editSkillModal"></i>
                                        </div>
                                        <div class="progress mb-3" style="height: 5px;">
                                            {% if skill.level == 1 %}
                                                <div class="progress-bar bg-success" role="progressbar"
                                                     style="width: 33%;" aria-valuenow="33" aria-valuemin="0"
                                                     aria-valuemax="100"></div>
                                            {% elif skill.level == 2 %}
                                                <div class="progress-bar bg-warning" role="progressbar"
                                                     style="width: 66%;" aria-valuenow="66" aria-valuemin="0"
                                                     aria-valuemax="100"></div>
                                            {% else %}
                                                <div class="progress-bar bg-danger" role="progressbar"
                                                     style="width: 100%;" aria-valuenow="100" aria-valuemin="0"
                                                     aria-valuemax="100"></div>
                                            {% endif %}
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                            <div class="mb-3 pb-2" style="height: 5px;">
                                <button type="button" class="btn btn-primary btn-sm" data-bs-toggle="modal"
                                        data-bs-target="#addSkillModal" onclick="fetchSkills(SKILLS_URL)">Add skill <i
                                        class="bi bi-plus-lg"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-12 mb-3">
                    <div class="card shadow h-100">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <h6 class="d-flex align-items-center mb-0">
                                    <i class="material-icons text-info mr-2">Projects</i>
                                </h6>
                                <button type="button" class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#addProjectModal">
                                    <i class="bi bi-plus-lg"></i> Add Project
                                </button>
                            </div>
                            <div id="projectsList">
                                <div class="card mb-3 project-card">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-start mb-2">
                                            <h5 class="card-title mb-0">E-commerce Platform</h5>
                                            <div class="dropdown">
                                                <button class="btn btn-link text-dark p-0" type="button" data-bs-toggle="dropdown">
                                                    <i class="bi bi-three-dots-vertical"></i>
                                                </button>
                                                <ul class="dropdown-menu">
                                                    <li><a class="dropdown-item" href="#" onclick="editProject(1)"><i class="bi bi-pencil me-2"></i>Edit</a></li>
                                                    <li><a class="dropdown-item text-danger" href="#" onclick="deleteProject(1)"><i class="bi bi-trash me-2"></i>Delete</a></li>
                                                </ul>
                                            </div>
                                        </div>
                                        <p class="card-text text-muted">A full-featured e-commerce platform with user authentication, product management, shopping cart, and payment integration.</p>
                                        <div class="mb-3">
                                            <span class="badge bg-primary me-1">React</span>
                                            <span class="badge bg-success me-1">Node.js</span>
                                            <span class="badge bg-info me-1">MongoDB</span>
                                            <span class="badge bg-warning me-1">Express</span>
                                        </div>
                                        <div class="d-flex gap-2">
                                            <a href="#" class="btn btn-outline-primary btn-sm" target="_blank">
                                                <i class="bi bi-github me-1"></i>GitHub
                                            </a>
                                            <a href="#" class="btn btn-outline-secondary btn-sm" target="_blank">
                                                <i class="bi bi-globe me-1"></i>Live Demo
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="addSkillModal" tabindex="-1" aria-labelledby="addSkillModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addSkillModalLabel">Add New Skill</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="invalid-feedback text-center fs-7" id="skillExistsFeedback">Skill already added.</div>
                    <form id="addSkillForm">
                        <div class="mb-3 position-relative">
                            <label for="searchSkillInput" class="form-label">Skill Name</label>
                            <input type="text" class="form-control" id="searchSkillInput"
                                   placeholder="Type to search..."/>
                            <div class="dropdown" style="position: relative;">
                                <select
                                        class="form-control custom-select-menu"
                                        id="skillNameSelect"
                                        size="5"
                                        style="max-height: 150px; overflow-y: auto; position: absolute; z-index: 1050; display: none; background: white; border: 1px solid #ced4da; width: 100%;"
                                >
                                </select>
                            </div>
                            <div class="invalid-feedback" id="skillNameFeedback">Skill name cannot be empty.</div>
                        </div>
                        <div class="mb-3 position-relative">
                            <label class="form-label">Skill Level</label>
                            <div class="progress position-relative" style="height: 30px; cursor: pointer;">
                                <div class="progress-bar bg-success" id="beginner" role="progressbar"
                                     style="width: 33%;" aria-valuenow="1" aria-valuemin="1" aria-valuemax="3">Beginner
                                </div>
                                <div class="progress-bar bg-warning" id="intermediate" role="progressbar"
                                     style="width: 33%;" aria-valuenow="2" aria-valuemin="1" aria-valuemax="3">
                                    Intermediate
                                </div>
                                <div class="progress-bar bg-danger" id="advanced" role="progressbar" style="width: 34%;"
                                     aria-valuenow="3" aria-valuemin="1" aria-valuemax="3">Advanced
                                </div>
                            </div>
                            <input type="hidden" id="skillLevelSelect" name="skillLevel" value="10"/>
                            <div class="invalid-feedback" id="skillLevelFeedback">Skill level cannot be empty.</div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="addSkillButton">Add</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="editSkillModal" tabindex="-1" aria-labelledby="editSkillModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editSkillModalLabel">Edit Skill</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editSkillForm">
                        <div class="mb-3 position-relative">
                            <label class="form-label">Skill Level</label>
                            <div class="progress position-relative"
                                 style="height: 30px; cursor: pointer;">
                                <div class="progress-bar bg-success" id="beginnerEdit" role="progressbar"
                                     style="width: 33%;" aria-valuenow="1" aria-valuemin="1" aria-valuemax="3">Beginner
                                </div>
                                <div class="progress-bar bg-warning" id="intermediateEdit" role="progressbar"
                                     style="width: 33%;" aria-valuenow="2" aria-valuemin="1" aria-valuemax="3">
                                    Intermediate
                                </div>
                                <div class="progress-bar bg-danger" id="advancedEdit" role="progressbar"
                                     style="width: 34%;" aria-valuenow="3" aria-valuemin="1" aria-valuemax="3">Advanced
                                </div>
                            </div>
                            <input type="hidden" id="skillLevelSelectEdit" name="skillLevel" value="10"/>
                        </div>
                    </form>

                </div>
                <div class="modal-footer">
                    <button id="removeSkillButton" type="button" class="btn btn-danger me-auto" data-bs-dismiss="modal">
                        Remove
                    </button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="saveSkillButton">Save</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="confirmRemoveSkillModal" tabindex="-1" aria-labelledby="confirmRemoveSkillModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="confirmRemoveSkillModalLabel">Confirm Removal</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    Are you sure you want to remove this skill?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-danger" id="confirmRemoveButton">Remove</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="profilePhotoModal" tabindex="-1" aria-labelledby="profilePhotoModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="profilePhotoModalLabel">Change Profile Photo</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="dropZone" class="border rounded p-5 text-center mb-3" style="border-style: dashed !important; cursor: pointer;">
                        <i class="bi bi-cloud-upload fs-1 mb-2"></i>
                        <h5>Drag and drop your photo here</h5>
                        <p class="text-muted">or</p>
                        <input type="file" id="fileInput" accept="image/*" style="display: none;">
                        <button class="btn btn-primary" onclick="document.getElementById('fileInput').click()">Browse Files</button>
                    </div>
                    <div id="previewContainer" class="text-center" style="display: none;">
                        <img id="imagePreview" class="img-fluid rounded mb-3" style="max-height: 200px;">
                        <div class="d-flex justify-content-center gap-2">
                            <button class="btn btn-secondary" onclick="resetUpload()">Cancel</button>
                            <button class="btn btn-primary" onclick="uploadPhoto()">Upload</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="socialLinksModal" tabindex="-1" aria-labelledby="socialLinksModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="socialLinksModalLabel">Manage Social Links</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="socialLinksForm">
                    </div>
                    <div class="mt-3">
                        <button type="button" class="btn btn-outline-primary btn-sm" onclick="addNewLinkField()">
                            <i class="bi bi-plus-lg"></i> Add New Link
                        </button>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveSocialLinks()">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="addProjectModal" tabindex="-1" aria-labelledby="addProjectModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addProjectModalLabel">Add New Project</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addProjectForm">
                        <div class="mb-3">
                            <label for="projectTitle" class="form-label">Project Title</label>
                            <input type="text" class="form-control" id="projectTitle" required>
                        </div>
                        <div class="mb-3">
                            <label for="projectDescription" class="form-label">Description</label>
                            <textarea class="form-control" id="projectDescription" rows="3" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Technologies</label>
                            <div class="d-flex flex-wrap gap-2" id="technologiesContainer">
                                <div class="input-group">
                                    <input type="text" class="form-control" placeholder="Add technology">
                                    <button class="btn btn-outline-secondary" type="button" onclick="addTechnology(this)">
                                        <i class="bi bi-plus-lg"></i>
                                    </button>
                                </div>
                            </div>
                            <div id="technologiesList" class="d-flex flex-wrap gap-2 mt-2"></div>
                        </div>
                        <div class="mb-3">
                            <label for="githubLink" class="form-label">GitHub Link</label>
                            <input type="url" class="form-control" id="githubLink" placeholder="https://github.com/...">
                        </div>
                        <div class="mb-3">
                            <label for="demoLink" class="form-label">Live Demo Link</label>
                            <input type="url" class="form-control" id="demoLink" placeholder="https://...">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveProject()">Save Project</button>
                </div>
            </div>
        </div>
    </div>

    <style>
        .project-card {
            transition: transform 0.2s ease-in-out;
        }
        .project-card:hover {
            transform: translateY(-5px);
        }
        .technology-badge {
            cursor: pointer;
            transition: all 0.2s ease-in-out;
        }
        .technology-badge:hover {
            opacity: 0.8;
        }
    </style>

    <script src="{% static 'js/worker-profile-add-skill-modal.js' %}"></script>
    <script src="{% static 'js/worker-profile-edit-skill.js' %}"></script>
    <script src="{% static 'js/worker-profile-common.js' %}"></script>
    <script src="{% static 'js/worker-profile-edit-about-me.js' %}"></script>
    <script>
        function updateLocationBadges() {
            const remoteCheck = document.getElementById('remoteCheck');
            const hybridCheck = document.getElementById('hybridCheck');
            const remoteBadge = document.getElementById('remoteBadge');
            const hybridBadge = document.getElementById('hybridBadge');
            const locationBadges = document.getElementById('locationBadges');

            locationBadges.style.display = 'flex';
            
            if (remoteCheck.checked) {
                remoteBadge.style.display = 'inline-block';
                remoteBadge.style.visibility = 'visible';
            } else {
                remoteBadge.style.display = 'none';
                remoteBadge.style.visibility = 'hidden';
            }
            
            if (hybridCheck.checked) {
                hybridBadge.style.display = 'inline-block';
                hybridBadge.style.visibility = 'visible';
            } else {
                hybridBadge.style.display = 'none';
                hybridBadge.style.visibility = 'hidden';
            }
        }

        function toggleEdit(field) {
            const contentDiv = document.getElementById(`${field}Content`);
            const editDiv = document.getElementById(`${field}Edit`);
            const editIcon = contentDiv.closest('.d-flex').querySelector('.edit-icon');
            const editButtons = contentDiv.closest('.d-flex').querySelector('.edit-buttons');
            
            if (contentDiv.style.display !== 'none') {
                contentDiv.style.display = 'none';
                editDiv.style.display = 'block';
                editIcon.classList.add('d-none');
                editButtons.classList.remove('d-none');
                
                const input = editDiv.querySelector('input, select');
                if (input) {
                    input.value = contentDiv.textContent.trim();
                }

                if (field === 'location') {
                    const remoteCheck = document.getElementById('remoteCheck');
                    const hybridCheck = document.getElementById('hybridCheck');
                    const remoteBadge = document.getElementById('remoteBadge');
                    const hybridBadge = document.getElementById('hybridBadge');

                    remoteCheck.checked = remoteBadge.style.display !== 'none';
                    hybridCheck.checked = hybridBadge.style.display !== 'none';
                    updateLocationBadges();
                }
            } else {
                contentDiv.style.display = 'block';
                editDiv.style.display = 'none';
                editIcon.classList.remove('d-none');
                editButtons.classList.add('d-none');
            }
        }

        function cancelEdit(field) {
            const contentDiv = document.getElementById(`${field}Content`);
            const editDiv = document.getElementById(`${field}Edit`);
            const editIcon = contentDiv.closest('.d-flex').querySelector('.edit-icon');
            const editButtons = contentDiv.closest('.d-flex').querySelector('.edit-buttons');
            
            contentDiv.style.display = 'block';
            editDiv.style.display = 'none';
            editIcon.classList.remove('d-none');
            editButtons.classList.add('d-none');

            if (field === 'location') {
                const remoteCheck = document.getElementById('remoteCheck');
                const hybridCheck = document.getElementById('hybridCheck');
                const remoteBadge = document.getElementById('remoteBadge');
                const hybridBadge = document.getElementById('hybridBadge');

                remoteCheck.checked = remoteBadge.style.display !== 'none';
                hybridCheck.checked = hybridBadge.style.display !== 'none';
                updateLocationBadges();
            }
        }

        function saveEdit(field) {
            const contentDiv = document.getElementById(`${field}Content`);
            const editDiv = document.getElementById(`${field}Edit`);
            const editIcon = contentDiv.closest('.d-flex').querySelector('.edit-icon');
            const editButtons = contentDiv.closest('.d-flex').querySelector('.edit-buttons');
            const input = editDiv.querySelector('input, select');
            
            if (input) {
                contentDiv.textContent = input.value;
                contentDiv.style.display = 'block';
                editDiv.style.display = 'none';
                editIcon.classList.remove('d-none');
                editButtons.classList.add('d-none');

                if (field === 'location') {
                    updateLocationBadges();
                }
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            const remoteCheck = document.getElementById('remoteCheck');
            const hybridCheck = document.getElementById('hybridCheck');
            if (remoteCheck && hybridCheck) {
                updateLocationBadges();
            }
        });

        document.addEventListener('DOMContentLoaded', function() {
            const dropZone = document.getElementById('dropZone');
            const fileInput = document.getElementById('fileInput');
            const profileImg = document.querySelector('.profile-img');
            const overlay = document.querySelector('.overlay');

            profileImg.parentElement.addEventListener('click', function() {
                const modal = new bootstrap.Modal(document.getElementById('profilePhotoModal'));
                modal.show();
            });

            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, preventDefaults, false);
            });

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            ['dragenter', 'dragover'].forEach(eventName => {
                dropZone.addEventListener(eventName, highlight, false);
            });

            ['dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, unhighlight, false);
            });

            function highlight(e) {
                dropZone.classList.add('bg-light');
            }

            function unhighlight(e) {
                dropZone.classList.remove('bg-light');
            }

            dropZone.addEventListener('drop', handleDrop, false);
            fileInput.addEventListener('change', handleFileSelect, false);

            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                handleFiles(files);
            }

            function handleFileSelect(e) {
                const files = e.target.files;
                handleFiles(files);
            }

            function handleFiles(files) {
                if (files.length > 0) {
                    const file = files[0];
                    if (file.type.startsWith('image/')) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            document.getElementById('imagePreview').src = e.target.result;
                            document.getElementById('previewContainer').style.display = 'block';
                            dropZone.style.display = 'none';
                        }
                        reader.readAsDataURL(file);
                    } else {
                        alert('Please select an image file.');
                    }
                }
            }
        });

        function resetUpload() {
            document.getElementById('fileInput').value = '';
            document.getElementById('previewContainer').style.display = 'none';
            document.getElementById('dropZone').style.display = 'block';
        }

        function uploadPhoto() {
            // TODO: Upload photo to server
            const preview = document.getElementById('imagePreview');
            const profileImg = document.querySelector('.profile-img');
            profileImg.src = preview.src;
            
            const modal = bootstrap.Modal.getInstance(document.getElementById('profilePhotoModal'));
            modal.hide();
            
            resetUpload();
        }

        const socialPlatforms = {
            website: { icon: 'globe', color: 'text-secondary', label: 'Personal Website' },
            github: { icon: 'github', color: 'text-dark', label: 'GitHub' },
            linkedin: { icon: 'linkedin', color: 'text-primary', label: 'LinkedIn' },
            gitlab: { icon: 'gitlab', color: 'text-danger', label: 'GitLab' },
            stackoverflow: { icon: 'stack-overflow', color: 'text-warning', label: 'Stack Overflow' },
            medium: { icon: 'medium', color: 'text-dark', label: 'Medium' },
            devto: { icon: 'dev', color: 'text-dark', label: 'Dev.to' },
            portfolio: { icon: 'briefcase', color: 'text-info', label: 'Portfolio' },
            other: { icon: 'link-45deg', color: 'text-secondary', label: 'Other' }
        };

        let socialLinks = [
            { platform: 'github', value: 'https://github.com/BartlomiejCzerwinski', displayName: '@BartlomiejCzerwinski' },
            { platform: 'linkedin', value: 'https://www.linkedin.com/in/bartlomiej-czerwinski/', displayName: 'Bartłomiej Czerwiński' }
        ];

        function renderSocialLinksList() {
            const list = document.getElementById('socialLinksList');
            list.innerHTML = '';
            
            socialLinks.forEach(link => {
                const platform = socialPlatforms[link.platform];
                const li = document.createElement('li');
                li.className = 'list-group-item d-flex justify-content-between align-items-center flex-wrap social-link-item';
                li.style.cursor = 'pointer';
                li.onclick = () => window.open(link.value, '_blank');
                li.innerHTML = `
                    <h6 class="mb-0">
                        <i class="bi bi-${platform.icon} ${platform.color} me-2"></i>
                        ${platform.label}
                    </h6>
                    <span class="text-secondary social-link-name">
                        ${link.displayName}
                    </span>
                `;
                list.appendChild(li);
            });
        }

        const style = document.createElement('style');
        style.textContent = `
            .social-link-item {
                transition: all 0.2s ease-in-out;
            }
            .social-link-item:hover {
                transform: scale(1.02);
                background-color: #f8f9fa;
            }
            .social-link-name {
                transition: all 0.2s ease-in-out;
            }
            .social-link-item:hover .social-link-name {
                transform: scale(1.1);
                color: #0d6efd !important;
            }
        `;
        document.head.appendChild(style);

        function renderSocialLinksForm() {
            const form = document.getElementById('socialLinksForm');
            form.innerHTML = '';
            
            socialLinks.forEach((link, index) => {
                const div = document.createElement('div');
                div.className = 'mb-3 position-relative';
                div.innerHTML = `
                    <div class="d-flex gap-2">
                        <div class="flex-grow-1">
                            <label class="form-label">Platform</label>
                            <select class="form-select" onchange="updatePlatform(${index}, this.value)">
                                ${Object.keys(socialPlatforms).map(platform => 
                                    `<option value="${platform}" ${platform === link.platform ? 'selected' : ''}>
                                        ${socialPlatforms[platform].label}
                                    </option>`
                                ).join('')}
                            </select>
                        </div>
                        <div class="flex-grow-1">
                            <label class="form-label">URL</label>
                            <input type="url" class="form-control" value="${link.value}" 
                                   onchange="updateValue(${index}, this.value)"
                                   placeholder="https://...">
                        </div>
                        <div class="flex-grow-1">
                            <label class="form-label">Display Name</label>
                            <input type="text" class="form-control" value="${link.displayName || ''}" 
                                   onchange="updateDisplayName(${index}, this.value)"
                                   placeholder="How it should appear">
                        </div>
                        <div class="d-flex align-items-end">
                            <button type="button" class="btn btn-outline-danger btn-sm mb-1" 
                                    onclick="removeLink(${index})">
                                <i class="bi bi-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
                form.appendChild(div);
            });
        }

        function addNewLinkField() {
            socialLinks.push({ platform: 'other', value: '', displayName: '' });
            renderSocialLinksForm();
        }

        function removeLink(index) {
            socialLinks.splice(index, 1);
            renderSocialLinksForm();
        }

        function updatePlatform(index, platform) {
            socialLinks[index].platform = platform;
            renderSocialLinksForm();
        }

        function updateValue(index, value) {
            socialLinks[index].value = value;
        }

        function updateDisplayName(index, name) {
            socialLinks[index].displayName = name;
        }

        function saveSocialLinks() {
            renderSocialLinksList();
            const modal = bootstrap.Modal.getInstance(document.getElementById('socialLinksModal'));
            modal.hide();
        }

        document.getElementById('socialLinksModal').addEventListener('show.bs.modal', function () {
            renderSocialLinksForm();
        });

        renderSocialLinksList();

        let projects = [];
        let technologies = new Set();

        function addTechnology(button) {
            const input = button.previousElementSibling;
            const technology = input.value.trim();
            
            if (technology && !technologies.has(technology)) {
                technologies.add(technology);
                const badge = document.createElement('span');
                badge.className = 'badge bg-primary technology-badge me-1';
                badge.textContent = technology;
                badge.onclick = () => {
                    technologies.delete(technology);
                    badge.remove();
                };
                document.getElementById('technologiesList').appendChild(badge);
                input.value = '';
            }
        }

        function saveProject() {
            const title = document.getElementById('projectTitle').value;
            const description = document.getElementById('projectDescription').value;
            const githubLink = document.getElementById('githubLink').value;
            const demoLink = document.getElementById('demoLink').value;
            
            if (!title || !description) {
                alert('Please fill in all required fields');
                return;
            }

            const project = {
                id: Date.now(),
                title,
                description,
                technologies: Array.from(technologies),
                githubLink,
                demoLink
            };

            projects.push(project);
            renderProjects();
            
            document.getElementById('addProjectForm').reset();
            technologies.clear();
            document.getElementById('technologiesList').innerHTML = '';
            
            const modal = bootstrap.Modal.getInstance(document.getElementById('addProjectModal'));
            modal.hide();
        }

        function renderProjects() {
            const container = document.getElementById('projectsList');
            container.innerHTML = '';
            
            projects.forEach(project => {
                const projectCard = document.createElement('div');
                projectCard.className = 'card mb-3 project-card';
                projectCard.innerHTML = `
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start mb-2">
                            <h5 class="card-title mb-0">${project.title}</h5>
                            <div class="dropdown">
                                <button class="btn btn-link text-dark p-0" type="button" data-bs-toggle="dropdown">
                                    <i class="bi bi-three-dots-vertical"></i>
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a class="dropdown-item" href="#" onclick="editProject(${project.id})"><i class="bi bi-pencil me-2"></i>Edit</a></li>
                                    <li><a class="dropdown-item text-danger" href="#" onclick="deleteProject(${project.id})"><i class="bi bi-trash me-2"></i>Delete</a></li>
                                </ul>
                            </div>
                        </div>
                        <p class="card-text text-muted">${project.description}</p>
                        <div class="mb-3">
                            ${project.technologies.map(tech => `<span class="badge bg-primary me-1">${tech}</span>`).join('')}
                        </div>
                        <div class="d-flex gap-2">
                            ${project.githubLink ? `
                                <a href="${project.githubLink}" class="btn btn-outline-primary btn-sm" target="_blank">
                                    <i class="bi bi-github me-1"></i>GitHub
                                </a>
                            ` : ''}
                            ${project.demoLink ? `
                                <a href="${project.demoLink}" class="btn btn-outline-secondary btn-sm" target="_blank">
                                    <i class="bi bi-globe me-1"></i>Live Demo
                                </a>
                            ` : ''}
                        </div>
                    </div>
                `;
                container.appendChild(projectCard);
            });
        }

        function editProject(id) {
            const project = projects.find(p => p.id === id);
            if (!project) return;

            document.getElementById('projectTitle').value = project.title;
            document.getElementById('projectDescription').value = project.description;
            document.getElementById('githubLink').value = project.githubLink || '';
            document.getElementById('demoLink').value = project.demoLink || '';
            
            technologies.clear();
            document.getElementById('technologiesList').innerHTML = '';
            project.technologies.forEach(tech => {
                technologies.add(tech);
                const badge = document.createElement('span');
                badge.className = 'badge bg-primary technology-badge me-1';
                badge.textContent = tech;
                badge.onclick = () => {
                    technologies.delete(tech);
                    badge.remove();
                };
                document.getElementById('technologiesList').appendChild(badge);
            });

            const modal = new bootstrap.Modal(document.getElementById('addProjectModal'));
            modal.show();

            const saveButton = document.querySelector('#addProjectModal .btn-primary');
            saveButton.onclick = () => {
                project.title = document.getElementById('projectTitle').value;
                project.description = document.getElementById('projectDescription').value;
                project.technologies = Array.from(technologies);
                project.githubLink = document.getElementById('githubLink').value;
                project.demoLink = document.getElementById('demoLink').value;

                renderProjects();
                modal.hide();
            };
        }

        function deleteProject(id) {
            if (confirm('Are you sure you want to delete this project?')) {
                projects = projects.filter(p => p.id !== id);
                renderProjects();
            }
        }

        projects.push({
            id: 1,
            title: 'E-commerce Platform',
            description: 'A full-featured e-commerce platform with user authentication, product management, shopping cart, and payment integration.',
            technologies: ['React', 'Node.js', 'MongoDB', 'Express'],
            githubLink: 'https://github.com/example/ecommerce',
            demoLink: 'https://ecommerce-demo.example.com'
        });
        renderProjects();
    </script>
{% endblock %}
